"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0});var t=e(require("shallowequal"));let n=null;function r(e){n=e}function o(e,t){for(let n=0;n<e.length;n++)if(e[n]===t)return e.splice(n,1),n;return-1}const s=Symbol("suspense"),l=Symbol("vnode");function u(e,t,...n){const r=n.length&&"number"==typeof n[n-1]?n[n.length-1]:null;t||(t={});let{key:o=null,ref:u=null,name:c=null,__test:f=null,...a}=t;const{__suspense_container:p,fallback:d,boundary:_,...h}=a;c&&(e.name=c),(n=i(n)).length&&(h.children=1===n.length?n[0]:n),"text"===n.type&&(h.children=n);let m=l;const g={};if(p&&(g.__suspense_container=!0),"function"==typeof e&&"Suspense"===e.prototype.constructor.name){if(m=s,!d)throw new Error("Suspense must get fallback prop!");d.__suspense_fallback=!0,g.pendings=new Map,g.fallback=d,g.boundary=_,g.__suspenseFlag=Symbol("suspense")}return{__type:m,key:o,ref:u,props:h,type:e,__test:f,...r?{patchFlag:r}:{},...g}}function i(e){return"string"==typeof(n=e)||"number"==typeof n||"symbol"==typeof n||"boolean"==typeof n?{type:"text",value:e,props:{},tag:0}:(t=e,"[object Array]"===Object.prototype.toString.call(t)?function(e){return Array.prototype.concat.apply([],e)}(e).map((e=>i(e))):e);var t,n}let c={},f=function(e,t){return e<t};function a(e,t,n,r){let o=e[n];for(;n>t;){let t=n-1>>1,s=e[t];if(!r(o,s))break;e[n]=s,n=t}e[n]=o}function p(e,t,n){let r=e.length,o=t,s=e[t],l=2*t+1;for(;l<r;){let o=l+1;o<r&&!n(e[l],e[o])&&(l=o),e[t]=e[l],l=2*(t=l)+1}e[t]=s,a(e,o,t,n)}c.push=function(e,t,n){e.push(t),a(e,0,e.length-1,n||f)},c.pop=function(e,t){if(e.length>0){let n=e.pop();if(e.length>0){let r=e[0];return e[0]=n,p(e,0,t||f),r}return n}},c.top=function(e){if(0!==e.length)return e[0]},c.pushpop=function(e,t,n){if(n=n||f,e.length>0&&n(e[0],t)){let r=e[0];e[0]=t,t=r,p(e,0,n)}return t},c.heapify=function(e,t){t=t||f;for(let n=Math.floor(e.length/2)-1;n>=0;--n)p(e,n,t);return e},c.heapsort=function(e,t){let n=[];for(let r=0;r<e.length;++r)c.push(n,e[r],t);let r=[];for(;n.length>0;)r.push(c.pop(n,t));return r};let d=30,_=d,h=d,m=[],g=null,b=null;const y=()=>performance.now();function k(e,t){const n=y(),r={cb:e,startTime:n,deadline:n+function(e){switch(e){case 1:return 0;case 16:default:return 144e4}}(t)};c.push(m,r,S),b=x,F()}function x(){let e=c.top(m);for(;e&&!(e.deadline>y()&&w());){const t=(0,e.cb)(e.deadline<=y());t?e.cb=t:(c.pop(m),e=c.top(m))}return!!e}let E,v;function C(){b&&b()?F():b=null}function w(){return y()>g}const F=(()=>{const{port1:e,port2:t}=new MessageChannel;return e.onmessage=C,e=>{!function(e){E=requestAnimationFrame((t=>{clearTimeout(v),e(t)})),v=setTimeout((()=>{cancelAnimationFrame(E),e(y())}),d)}((n=>{var r;_=(r=n)-g+h,_<h&&d<h&&(_<8?_=8:h=_>d?_:d),d=_,g=r+h,e?e(n):t.postMessage(null)}))}})();function S(e,t){return e.deadline-t.deadline}const A=(e,n)=>(void 0!==e||void 0!==n)&&t.default(e,n);function P(e){return"function"==typeof e}const j=function(){this.state=null,this.next=null,this.deps=null,this.effect=null,this.clear=null,this.init=!0};let M;function O(e){return Q(L(((e,t)=>{if("function"!=typeof t)return t;return t(e)}),[]),e)}function Q(e,t){const[n,r]=M(),o=L((t=>{let o=e(n.state,t);A(o,n.state)||(n.state=o,te(r))}),[e]);return K(n,(e=>{"function"==typeof t&&(t=t()),e.state=t})),[n.state,o]}function L(e,t){return q((()=>e),t)}function I(e,t,n=!1){const[r,o]=M(),s=r.deps;if(!A(s,t)){r.deps=t,r.cb=e;const s=o.hooks[n?"layout":"effect"];null!=r.effect?s[r.effect].effect=e:(s.push({effect:e}),r.effect=s.length-1),s[r.effect].call=!0}}function R(e,t,n){const[r]=M(),o=r.deps;let s;if(A(o,t)||(r.deps=t,s=e()),n){("layout"===n?D:I)((()=>s),t)}}function T(e){return q((()=>({current:e})),[])}function q(e,t){const[n]=M();return K(n,(n=>{n.state=e(),n.deps=t}))||A(t,n.deps)?n.state:n.state=e()}function B(e,t=(e=>e)){const[n,r]=Q((e=>e+1),0),o=T(t(e.value));return R((()=>{let n=e=>{t(e)!==o.current&&(o.current=e,r())};return e.addSub(n),()=>e.deleteSub(n)}),[],"effect"),o.current}function D(e,t){I(e,t,!0)}function N(e){return e.filter((e=>!!e.call&&(e.call=!1,!0)))}function z(){const e=n;let t=(e.hooks?e.hooks:e.hooks={hookList:new j,effect:[],layout:[]}).hookList;return()=>{t.next||(t.next=new j),t=t.next;return[t,e]}}function K(e,t){return!!e.init&&(function(e){e.init=!1}(e),t(e),!0)}function V(e){const t=(0,e.effect)();P(t)&&(e.clear=t)}function W(e){const{clear:t}=e;t&&t()}function G(e,t=!0){const{oldProps:n={},props:r}=e,o=e.node;for(const e in{...n,...r}){const s=n[e],l=r[e];if(n===l||"children"===e)return;if("style"===e){const e=l,t=s;for(let n in Object.assign(t,e))o.style[n]=e[n]||""}else if("on"==e.substring(0,2)){if(t){const t=e[2].toLowerCase()+e.substring(3);r[e]?n[e]?n[e]&&r[e]&&n[e]!==r[e]&&(o.removeEventListener(t,n[e]),o.addEventListener(t,r[e])):o.addEventListener(t,r[e]):o.removeEventListener(t,n[e])}}else"key"===e||(!1===r[e]||null==r[e]?o.removeAttribute(e):"ref"===e?"function"==typeof r[e]&&r[e](o):o.setAttribute(e,r[e]))}}const H=[],J=new Map,U=new Map,X=[];let Y,Z,$=[];function ee(e,t,n){te(function(e,t,n){return{node:t,done:n,props:{children:e},tag:0,RootFiber:!0}}(e,t,n))}function te(e,t){const n=e.__priority||16;t?X.push(e):!e.dirty&&X.push(e)&&(e.dirty=!0),k(ne,n)}function ne(e){if(Z||(Z=X.shift()),Z=function(e,t){for(;e&&(!w()||t);)try{e=re(e)}catch(e){console.log(e);break}return e}(Z,e),Z&&!e)return ne.bind(null);for(;H.length;){H.shift()()}return X.length?ne.bind(null):(Y&&function(e){e.beforeCommit&&e.beforeCommit(),e.__skip_commit&&$.forEach((e=>ie(e)));J.forEach((e=>{e.filter((e=>!e.uncompleted)).forEach((e=>ie(e)))})),e.__resumeCommit&&$.unshift(e.__resumeCommit);$.forEach((e=>function(e){const{effect:t,hooks:n,ref:r,uncompleted:o}=e;if(o||32===t)return;16===t||(1===t?function(e){const t=e.parentElementFiber.node;let n=e;for(;n&&1===n.tag;)n=n.child;n&&t.removeChild(n.node),e.hooks&&(e.hooks.effect.forEach((e=>e.clear&&F(e.clear()))),e.hooks.layout.forEach((e=>e.clear&&e.clear())))}(e):1===e.tag?n&&function(e){const t=N(e.layout);t.forEach(W),t.forEach(V),F((()=>{const t=N(e.effect);t.forEach(W),t.forEach(V)}))}(n):2===t?G(e,!0):8===t?function(e){const t=e.node,n=e.parentElementFiber,r=n?n.node:e.mountDom,o=e.insertPoint?e.insertPoint:null;let s=o?o.node.nextSibling:null;r.insertBefore(t,s)}(e):4===t&&function(e){const t=e.node,n=e.parentElementFiber,r=n?n.node:e.mountDom,o=e.childIndex;r.insertBefore(t,r.childNodes[o+1])}(e));Object.prototype.hasOwnProperty.call(e,"uncommited_effect")&&delete e.uncommited_effect;!function(e,t){P(e)?e(t):e&&(e.current=t)}(r,e.node)}(e))),e.done&&e.done(),$=[],Y=null,r(null),U.clear(),J.forEach(((e,t,n)=>{e.length||n.remove(t)})),e.afterCommit&&e.afterCommit()}(Y),null)}function re(e){if(e.__type===s&&J.get(e.__suspenseFlag)&&e.props.children&&!e.props.children.__suspense_fallback)return oe(e);let t;e.parentElementFiber=function(e){if(!e.parent)return null;for(e=e.parent;e&&1===e.tag;)e=e.parent;return e}(e);let n,o=null;if(n=ce(e)){const e=n.__suspenseFlag;if(o=U.get(e))o=U.get(e);else{const t=[];o=t,U.set(e,t)}}return t=function(e,t){let n,o;try{n=0==e.tag?function(e){e.node||function(e){if(P(e.type))throw new Error("vnode is not Element Type");const t="text"===e.type?document.createTextNode(e.value):document.createElement(e.type);e.node=t,t._limbo__fiber=e,G(e,!0)}(e);se(e);let t=e.parentElementFiber||{};if(!e.insertPoint){let n=t.last;for(;n&&0!==n.tag;)n=n.child;e.insertPoint=n}return t.last=e,e.node.last=null,ue(e,e.props.children),!0}(e):function(e){const t=e.oldProps,n=e.props;if(!e.dirty&&!function(e,t){return!A(e,t)}(t,n)){if(!e.uncompleted)return e.effect=16,!1;se(e)}r(e),M=z();const o=(0,e.type)(n);return ue(e,o),!0}(e)}catch(t){if((l=t)instanceof Promise&&"function"==typeof l.then){const n=ce(e);if(!n)throw Error("maybe need Suspense Wrap Component!");if(!n.fallback)throw Error("Suspense must get fallback prop!");n.pendings.get(t)?n.pendings.get(t).push(e):n.pendings.set(t,[e]),e.dirty&&(e.dirty=!1),e.uncompleted=!0;const{fallback:r}=n;if(J.get(n.__suspenseFlag)||J.set(n.__suspenseFlag,U.get(n.__suspenseFlag)),n.__resuming1||n.__resuming2){if(n.__resuming2){n.__resuming2=!1,n.__resumeCommit=null;const e=n.child;e.child=e.__fallback_child,e.kids=e.__fallback_kids,e.props.children=e.__fallback_children}}else n.__resuming1=!0,H.push((()=>{n.__children=n.props.children,n.props.children=r;const e=n.child;e.__resume_child=e.child,e.__resume_kids=e.kids,e.__resume_children=e.props.children,e.child=null,e.kids=null,te(n)}));const o=()=>{const e=e=>n.pendings.get(e),r=()=>n.pendings.size;if(t.__limbo_handing)return;t.__limbo_handing=!0;const o=()=>{const o=e(t);if(n.pendings.delete(t),r())o.forEach((e=>{e.__skip_commit=!0,e.beforeCommit=()=>{const t=U.get(n.__suspenseFlag).slice(1),r=J.get(n.__suspenseFlag),o=r.findIndex((t=>t===e));r[o].uncompleted=!1,r.splice(o+1,0,...t),delete e.beforeCommit},e.afterCommit=()=>{delete e.__skip_commit,delete e.afterCommit,n.__resumeQueue.shift(),s()},te(e)}));else{n.__resuming2=!0;const e=n.child,t=e.child;e.__fallback_child=e.child,e.__fallback_kids=e.kids,e.__fallback_children=e.props.children,t.effect=1,n.__resumeCommit=t,e.kids=e.__resume_kids,e.child=e.__resume_child,e.props.children=e.__resume_children,n.props.children=n.__children,J.delete(n.__suspenseFlag),n.beforeCommit=()=>{delete n.beforeCommit,n.__resuming2&&(delete n.__resuming1,delete e.__resume_kids,delete e.__resume_children,delete e.__resume_child),delete n.__resuming2,delete n.__resumeQueue,delete e.__fallback_child,delete e.__fallback_kids,delete e.__fallback_children},n.afterCommit=()=>{delete n.afterCommit,delete n.__resumeCommit},te(n)}},s=()=>{if(!n.__resumeQueue.length)return;(0,n.__resumeQueue[0])()};n.__resumeQueue&&n.__resumeQueue.length?n.__resumeQueue.push(o):(n.__resumeQueue?n.__resumeQueue.push(o):n.__resumeQueue=[o],s())},s=e=>{throw e};t.then((e=>o()),(e=>s()))}else o=t}finally{if(e.__type===s&&$.includes(e)||$.push(e),!t||e.__suspense_container||function(e){for(;e&&!e.__suspense_fallback;)e=e.parent;return e&&e.__suspense_fallback?e:null}(e)||(Array.isArray(t[0])?t.forEach((t=>t.push(e))):t.push(e)),o)throw o;return n&&(e&&e.child)?e.child:null}var l}(e,o),t||(t=oe(e)),t}function oe(e){for(;e;){if(!1===e.dirty&&!Y)return Y=e,null;if(e.sibling)return e.sibling;e=e.parent}}function se(e){if(e.restoring)return delete e.restoring,e.uncompleted=!1,!0}function le(e,t){if("text"!==e.type||"text"!==t.type)throw Error("reconcileText must be text type.");var n,r;e.value!==t.Value&&(n=t,r=e.value,n.node.textContent=r),e.effect||(e.effect=16)}function ue(e,t){if(!t)return;const n=e.kids||{},r=e.kids=function(e){let t={};Array.isArray(e)?e.forEach(((e,n)=>{e&&(Array.isArray(e)&&e.forEach(((e,n)=>{t[pe(2,n,e.key)]=e,e.childIndex=n})),t[pe(1,n,e.key)]=e,e.childIndex=n)})):t[pe(0,0,e.key)]=e;return t}(t),o={};for(let e in n){const t=n[e],s=r[e];t&&s&&fe(t,s)?o[e]=t:(t.effect=1,$.push(t))}!function(e){const t=e.filter((e=>e.childIndex)).map((e=>e.childIndex-1)),n=[];t.length&&(n[0]=t[0]);for(let e=0;e<t.length;e++)if(t[e]>n[n.length-1])n[n.length]=t[e];else{const r=ae(n,t[e]);if(t[e]>n[r])continue;if(n[r]===t[e])continue;0===r?n[0]=t[e]:n[r]=t[e]}n.forEach((t=>{e[t].__stable=!0}))}(Object.values(o));let s=null;for(let t in r){let n=r[t],i=o[t];if(i&&fe(n,i)){const e=n.childIndex,t=i.childIndex;32===i.effect?(n.effect=i.uncommited_effect,delete i.uncommited_effect,n.restoring=!0):n.effect=2,n={...i,...n},n.oldProps=i.props,e!==t&&(i.__stable?delete i.__stable:(n.effect=4,n.replaced=i)),"text"===i.type&&"text"===n.type&&le(n,i)}else l=n,u=8,n={...l,tag:l.tag||"function"==typeof l.type?1:0,effect:u};r[t]=n,n.parent=e,s?s.sibling=n:e.child=n,s=n}var l,u;s&&(s.sibling=null),e.kids=r,e.dirty=!e.dirty&&null}function ie(e){e.uncompleted=!0,e.uncommited_effect=e.effect,e.effect=32}function ce(e){for(;e&&e.__type!==s;)e=e.parent;return e&&e.__type===s?e:null}function fe(e,t){return e.type===t.type&&e.key===t.key}function ae(e,t){let n=0,r=e.length-1;for(;n<r;){const o=n+(r-n>>1);e[o]<t?n=o+1:e[o]>=t&&(r=o)}return n}function pe(e,t,n){if(null==t)throw"Error: not order y";return null==n?e+"."+t:e+".."+n}const de=new Map;function _e(e,t){return Array.isArray(e)?e.indexOf(t)>-1:"string"==typeof e?e.split(",").indexOf(t)>-1:"[object RegExp]"===Object.prototype.toString.call(e)&&e.test(t)}function he({children:e}){return function(e,t,...n){return u(e,t={...t,__block:!0,tag:1},n)}("Fragment",null,e)}const me={render:ee,h:u,createElement:u,useState:O,useEffect:I,useAction:R,useRef:T,useReducer:Q,useMemo:q,useLayoutEffect:D,useContext:B,useCallback:L,Fragment:he};exports.Fragment=he,exports.KeepAlive=function(e){const[t,n]=O([]),{children:r,max:s,include:l,exclude:u}=e,i=r.name;let c=!1;if(R((()=>{(l&&(!i||!_e(l,i))||u&&i&&_e(u,i))&&(c=!0)}),[l,u,i]),c)return r;const f=r.key;return de.get(f)?(r.node=de.get(f),o(t,f),t.push(f),n(t)):(de.set(f,r),t.push(f),t.length>s&&function(e,t,n){o(t,n),e.set(n,null)}(de,t,t[0]),n(t)),r},exports.Suspense=function({children:e}){return u("div",{__suspense_container:!0,class:"__limbo_suspense_container"},e)},exports.createContext=function(e){const t={value:e,_subscribe:new Set,Provider:function({value:e,children:n}){return R((()=>{t.value=e}),[e]),D((()=>{t.updateSub()}),[e]),n},Consumer:function({children:e,selector:n}){return function(e,t){const n=Object.assign({},e.props,t);return{...e,props:n}}(e,{value:B(t,n)})},addSub(e){this._subscribe.add(e)},updateSub(){this._subscribe.forEach((e=>{e(this.value)}))},deleteSub(e){this._subscribe.delete(e)}};return t},exports.createElement=u,exports.default=me,exports.h=u,exports.render=ee,exports.useAction=R,exports.useCallback=L,exports.useContext=B,exports.useEffect=I,exports.useLayoutEffect=D,exports.useMemo=q,exports.useReducer=Q,exports.useRef=T,exports.useState=O;
