"use strict";Object.defineProperty(exports,"__esModule",{value:!0});let e=null;function t(t){e=t}function n(e,t){for(let n=0;n<e.length;n++)if(e[n]===t)return e.splice(n,1),n;return-1}const r=Symbol("suspense"),o=Symbol("vnode");function s(e,t,...n){const s=n.length&&"number"==typeof n[n-1]?n[n.length-1]:null;t||(t={});let{key:i=null,ref:u=null,name:c=null,__test:f=null,...a}=t;const{__suspense_container:p,fallback:d,boundary:_,...h}=a;c&&(e.name=c),(n=l(n)).length&&(h.children=1===n.length?n[0]:n),"text"===n.type&&(h.children=n);let m=o;const g={};if(p&&(g.__suspense_container=!0),"function"==typeof e&&"Suspense"===e.prototype.constructor.name){if(m=r,!d)throw new Error("Suspense must get fallback prop!");d.__suspense_fallback=!0,g.pendings=new Map,g.fallback=d,g.boundary=_,g.__suspenseFlag=Symbol("suspense")}return{__type:m,key:i,ref:u,props:h,type:e,__test:f,...s?{patchFlag:s}:{},...g}}function l(e){return"string"==typeof(n=e)||"number"==typeof n||"symbol"==typeof n||"boolean"==typeof n?{type:"text",value:e,props:{},tag:0}:(t=e,"[object Array]"===Object.prototype.toString.call(t)?function(e){return Array.prototype.concat.apply([],e)}(e).map((e=>l(e))):e);var t,n}let i={},u=function(e,t){return e<t};function c(e,t,n,r){let o=e[n];for(;n>t;){let t=n-1>>1,s=e[t];if(!r(o,s))break;e[n]=s,n=t}e[n]=o}function f(e,t,n){let r=e.length,o=t,s=e[t],l=2*t+1;for(;l<r;){let o=l+1;o<r&&!n(e[l],e[o])&&(l=o),e[t]=e[l],l=2*(t=l)+1}e[t]=s,c(e,o,t,n)}i.push=function(e,t,n){e.push(t),c(e,0,e.length-1,n||u)},i.pop=function(e,t){if(e.length>0){let n=e.pop();if(e.length>0){let r=e[0];return e[0]=n,f(e,0,t||u),r}return n}},i.top=function(e){if(0!==e.length)return e[0]},i.pushpop=function(e,t,n){if(n=n||u,e.length>0&&n(e[0],t)){let r=e[0];e[0]=t,t=r,f(e,0,n)}return t},i.heapify=function(e,t){t=t||u;for(let n=Math.floor(e.length/2)-1;n>=0;--n)f(e,n,t);return e},i.heapsort=function(e,t){let n=[];for(let r=0;r<e.length;++r)i.push(n,e[r],t);let r=[];for(;n.length>0;)r.push(i.pop(n,t));return r};let a=30,p=a,d=a,_=[],h=null,m=null;const g=()=>performance.now();function b(e,t){const n=g(),r={cb:e,startTime:n,deadline:n+function(e){switch(e){case 1:return 0;case 16:default:return 144e4}}(t)};i.push(_,r,w),m=y,C()}function y(){let e=i.top(_);for(;e&&!(e.deadline>g()&&E());){const t=(0,e.cb)(e.deadline<=g());t?e.cb=t:(i.pop(_),e=i.top(_))}return!!e}let k,x;function v(){m&&m()?C():m=null}function E(){return g()>h}const C=(()=>{const{port1:e,port2:t}=new MessageChannel;return e.onmessage=v,e=>{!function(e){k=requestAnimationFrame((t=>{clearTimeout(x),e(t)})),x=setTimeout((()=>{cancelAnimationFrame(k),e(g())}),a)}((n=>{var r;p=(r=n)-h+d,p<d&&a<d&&(p<8?p=8:d=p>a?p:a),a=p,h=r+d,e?e(n):t.postMessage(null)}))}})();function w(e,t){return e.deadline-t.deadline}const F=(e,t)=>(void 0!==e||void 0!==t)&&function(e,t,n,r){var o=n?n.call(r,e,t):void 0;if(void 0!==o)return!!o;if(e===t)return!0;if("object"!=typeof e||!e||"object"!=typeof t||!t)return!1;var s=Object.keys(e),l=Object.keys(t);if(s.length!==l.length)return!1;for(var i=Object.prototype.hasOwnProperty.bind(t),u=0;u<s.length;u++){var c=s[u];if(!i(c))return!1;var f=e[c],a=t[c];if(!1===(o=n?n.call(r,f,a,c):void 0)||void 0===o&&f!==a)return!1}return!0}(e,t);function S(e){return"function"==typeof e}const A=function(){this.state=null,this.next=null,this.deps=null,this.effect=null,this.clear=null,this.init=!0};let j;function O(e){return P(M(((e,t)=>{if("function"!=typeof t)return t;return t(e)}),[]),e)}function P(e,t){const[n,r]=j(),o=M((t=>{let o=e(n.state,t);F(o,n.state)||(n.state=o,$(r))}),[e]);return q(n,(e=>{"function"==typeof t&&(t=t()),e.state=t})),[n.state,o]}function M(e,t){return R((()=>e),t)}function Q(e,t,n=!1){const[r,o]=j(),s=r.deps;if(!F(s,t)){r.deps=t,r.cb=e;const s=o.hooks[n?"layout":"effect"];null!=r.effect?s[r.effect].effect=e:(s.push({effect:e}),r.effect=s.length-1),s[r.effect].call=!0}}function L(e,t,n){const[r]=j(),o=r.deps;let s;if(F(o,t)||(r.deps=t,s=e()),n){("layout"===n?B:Q)((()=>s),t)}}function I(e){return R((()=>({current:e})),[])}function R(e,t){const[n]=j();return q(n,(n=>{n.state=e(),n.deps=t}))||F(t,n.deps)?n.state:n.state=e()}function T(e,t=(e=>e)){const[n,r]=P((e=>e+1),0),o=I(t(e.value));return L((()=>{let n=e=>{t(e)!==o.current&&(o.current=e,r())};return e.addSub(n),()=>e.deleteSub(n)}),[],"effect"),o.current}function B(e,t){Q(e,t,!0)}function D(e){return e.filter((e=>!!e.call&&(e.call=!1,!0)))}function N(){const t=e;let n=(t.hooks?t.hooks:t.hooks={hookList:new A,effect:[],layout:[]}).hookList;return()=>{n.next||(n.next=new A),n=n.next;return[n,t]}}function q(e,t){return!!e.init&&(function(e){e.init=!1}(e),t(e),!0)}function z(e){const t=(0,e.effect)();S(t)&&(e.clear=t)}function K(e){const{clear:t}=e;t&&t()}function V(e,t=!0){const{oldProps:n={},props:r}=e,o=e.node;for(const e in{...n,...r}){const s=n[e],l=r[e];if(n===l||"children"===e)return;if("style"===e){const e=l,t=s;for(let n in Object.assign(t,e))o.style[n]=e[n]||""}else if("on"==e.substring(0,2)){if(t){const t=e[2].toLowerCase()+e.substring(3);r[e]?n[e]?n[e]&&r[e]&&n[e]!==r[e]&&(o.removeEventListener(t,n[e]),o.addEventListener(t,r[e])):o.addEventListener(t,r[e]):o.removeEventListener(t,n[e])}}else"key"===e||(!1===r[e]||null==r[e]?o.removeAttribute(e):"ref"===e?"function"==typeof r[e]&&r[e](o):o.setAttribute(e,r[e]))}}const W=[],G=new Map,H=new Map,J=[];let U,X,Y=[];function Z(e,t,n){$(function(e,t,n){return{node:t,done:n,props:{children:e},tag:0,RootFiber:!0}}(e,t,n))}function $(e,t){const n=e.__priority||16;t?J.push(e):!e.dirty&&J.push(e)&&(e.dirty=!0),b(ee,n)}function ee(e){if(X||(X=J.shift()),X=function(e,t){for(;e&&(!E()||t);)try{e=te(e)}catch(e){console.log(e);break}return e}(X,e),X&&!e)return ee.bind(null);for(;W.length;){W.shift()()}return J.length?ee.bind(null):(U&&function(e){e.beforeCommit&&e.beforeCommit(),e.__skip_commit&&Y.forEach((e=>le(e)));G.forEach((e=>{e.filter((e=>!e.uncompleted)).forEach((e=>le(e)))})),e.__resumeCommit&&Y.unshift(e.__resumeCommit);Y.forEach((e=>function(e){const{effect:t,hooks:n,ref:r,uncompleted:o}=e;if(o||32===t)return;16===t||(1===t?function(e){const t=e.parentElementFiber.node;let n=e;for(;n&&1===n.tag;)n=n.child;n&&t.removeChild(n.node),e.hooks&&(e.hooks.effect.forEach((e=>e.clear&&C(e.clear()))),e.hooks.layout.forEach((e=>e.clear&&e.clear())))}(e):1===e.tag?n&&function(e){const t=D(e.layout);t.forEach(K),t.forEach(z),C((()=>{const t=D(e.effect);t.forEach(K),t.forEach(z)}))}(n):2===t?V(e,!0):8===t?function(e){const t=e.node,n=e.parentElementFiber,r=n?n.node:e.mountDom,o=e.insertPoint?e.insertPoint:null;let s=o?o.node.nextSibling:null;r.insertBefore(t,s)}(e):4===t&&function(e){const t=e.node,n=e.parentElementFiber,r=n?n.node:e.mountDom,o=e.childIndex;r.insertBefore(t,r.childNodes[o+1])}(e));Object.prototype.hasOwnProperty.call(e,"uncommited_effect")&&delete e.uncommited_effect;!function(e,t){S(e)?e(t):e&&(e.current=t)}(r,e.node)}(e))),e.done&&e.done(),Y=[],U=null,t(null),H.clear(),G.forEach(((e,t,n)=>{e.length||n.remove(t)})),e.afterCommit&&e.afterCommit()}(U),null)}function te(e){if(e.__type===r&&G.get(e.__suspenseFlag)&&e.props.children&&!e.props.children.__suspense_fallback)return ne(e);let n;e.parentElementFiber=function(e){if(!e.parent)return null;for(e=e.parent;e&&1===e.tag;)e=e.parent;return e}(e);let o,s=null;if(o=ie(e)){const e=o.__suspenseFlag;if(s=H.get(e))s=H.get(e);else{const t=[];s=t,H.set(e,t)}}return n=function(e,n){let o,s;try{o=0==e.tag?function(e){e.node||function(e){if(S(e.type))throw new Error("vnode is not Element Type");const t="text"===e.type?document.createTextNode(e.value):document.createElement(e.type);e.node=t,t._limbo__fiber=e,V(e,!0)}(e);re(e);let t=e.parentElementFiber||{};if(!e.insertPoint){let n=t.last;for(;n&&0!==n.tag;)n=n.child;e.insertPoint=n}return t.last=e,e.node.last=null,se(e,e.props.children),!0}(e):function(e){const n=e.oldProps,r=e.props;if(!e.dirty&&!function(e,t){return!F(e,t)}(n,r)){if(!e.uncompleted)return e.effect=16,!1;re(e)}t(e),j=N();const o=(0,e.type)(r);return se(e,o),!0}(e)}catch(t){if((l=t)instanceof Promise&&"function"==typeof l.then){const n=ie(e);if(!n)throw Error("maybe need Suspense Wrap Component!");if(!n.fallback)throw Error("Suspense must get fallback prop!");n.pendings.get(t)?n.pendings.get(t).push(e):n.pendings.set(t,[e]),e.dirty&&(e.dirty=!1),e.uncompleted=!0;const{fallback:r}=n;if(G.get(n.__suspenseFlag)||G.set(n.__suspenseFlag,H.get(n.__suspenseFlag)),n.__resuming1||n.__resuming2){if(n.__resuming2){n.__resuming2=!1,n.__resumeCommit=null;const e=n.child;e.child=e.__fallback_child,e.kids=e.__fallback_kids,e.props.children=e.__fallback_children}}else n.__resuming1=!0,W.push((()=>{n.__children=n.props.children,n.props.children=r;const e=n.child;e.__resume_child=e.child,e.__resume_kids=e.kids,e.__resume_children=e.props.children,e.child=null,e.kids=null,$(n)}));const o=()=>{const e=e=>n.pendings.get(e),r=()=>n.pendings.size;if(t.__limbo_handing)return;t.__limbo_handing=!0;const o=()=>{const o=e(t);if(n.pendings.delete(t),r())o.forEach((e=>{e.__skip_commit=!0,e.beforeCommit=()=>{const t=H.get(n.__suspenseFlag).slice(1),r=G.get(n.__suspenseFlag),o=r.findIndex((t=>t===e));r[o].uncompleted=!1,r.splice(o+1,0,...t),delete e.beforeCommit},e.afterCommit=()=>{delete e.__skip_commit,delete e.afterCommit,n.__resumeQueue.shift(),s()},$(e)}));else{n.__resuming2=!0;const e=n.child,t=e.child;e.__fallback_child=e.child,e.__fallback_kids=e.kids,e.__fallback_children=e.props.children,t.effect=1,n.__resumeCommit=t,e.kids=e.__resume_kids,e.child=e.__resume_child,e.props.children=e.__resume_children,n.props.children=n.__children,G.delete(n.__suspenseFlag),n.beforeCommit=()=>{delete n.beforeCommit,n.__resuming2&&(delete n.__resuming1,delete e.__resume_kids,delete e.__resume_children,delete e.__resume_child),delete n.__resuming2,delete n.__resumeQueue,delete e.__fallback_child,delete e.__fallback_kids,delete e.__fallback_children},n.afterCommit=()=>{delete n.afterCommit,delete n.__resumeCommit},$(n)}},s=()=>{if(!n.__resumeQueue.length)return;(0,n.__resumeQueue[0])()};n.__resumeQueue&&n.__resumeQueue.length?n.__resumeQueue.push(o):(n.__resumeQueue?n.__resumeQueue.push(o):n.__resumeQueue=[o],s())},s=e=>{throw e};t.then((e=>o()),(e=>s()))}else s=t}finally{if(e.__type===r&&Y.includes(e)||Y.push(e),!n||e.__suspense_container||function(e){for(;e&&!e.__suspense_fallback;)e=e.parent;return e&&e.__suspense_fallback?e:null}(e)||(Array.isArray(n[0])?n.forEach((t=>t.push(e))):n.push(e)),s)throw s;return o&&(e&&e.child)?e.child:null}var l}(e,s),n||(n=ne(e)),n}function ne(e){for(;e;){if(!1===e.dirty&&!U)return U=e,null;if(e.sibling)return e.sibling;e=e.parent}}function re(e){if(e.restoring)return delete e.restoring,e.uncompleted=!1,!0}function oe(e,t){if("text"!==e.type||"text"!==t.type)throw Error("reconcileText must be text type.");var n,r;e.value!==t.Value&&(n=t,r=e.value,n.node.textContent=r),e.effect||(e.effect=16)}function se(e,t){if(!t)return;const n=e.kids||{},r=e.kids=function(e){let t={};Array.isArray(e)?e.forEach(((e,n)=>{e&&(Array.isArray(e)&&e.forEach(((e,n)=>{t[fe(2,n,e.key)]=e,e.childIndex=n})),t[fe(1,n,e.key)]=e,e.childIndex=n)})):t[fe(0,0,e.key)]=e;return t}(t),o={};for(let e in n){const t=n[e],s=r[e];t&&s&&ue(t,s)?o[e]=t:(t.effect=1,Y.push(t))}!function(e){const t=e.filter((e=>e.childIndex)).map((e=>e.childIndex-1)),n=[];t.length&&(n[0]=t[0]);for(let e=0;e<t.length;e++)if(t[e]>n[n.length-1])n[n.length]=t[e];else{const r=ce(n,t[e]);if(t[e]>n[r])continue;if(n[r]===t[e])continue;0===r?n[0]=t[e]:n[r]=t[e]}n.forEach((t=>{e[t].__stable=!0}))}(Object.values(o));let s=null;for(let t in r){let n=r[t],u=o[t];if(u&&ue(n,u)){const e=n.childIndex,t=u.childIndex;32===u.effect?(n.effect=u.uncommited_effect,delete u.uncommited_effect,n.restoring=!0):n.effect=2,n={...u,...n},n.oldProps=u.props,e!==t&&(u.__stable?delete u.__stable:(n.effect=4,n.replaced=u)),"text"===u.type&&"text"===n.type&&oe(n,u)}else l=n,i=8,n={...l,tag:l.tag||"function"==typeof l.type?1:0,effect:i};r[t]=n,n.parent=e,s?s.sibling=n:e.child=n,s=n}var l,i;s&&(s.sibling=null),e.kids=r,e.dirty=!e.dirty&&null}function le(e){e.uncompleted=!0,e.uncommited_effect=e.effect,e.effect=32}function ie(e){for(;e&&e.__type!==r;)e=e.parent;return e&&e.__type===r?e:null}function ue(e,t){return e.type===t.type&&e.key===t.key}function ce(e,t){let n=0,r=e.length-1;for(;n<r;){const o=n+(r-n>>1);e[o]<t?n=o+1:e[o]>=t&&(r=o)}return n}function fe(e,t,n){if(null==t)throw"Error: not order y";return null==n?e+"."+t:e+".."+n}const ae=new Map;function pe(e,t){return Array.isArray(e)?e.indexOf(t)>-1:"string"==typeof e?e.split(",").indexOf(t)>-1:"[object RegExp]"===Object.prototype.toString.call(e)&&e.test(t)}function de({children:e}){return function(e,t,...n){return s(e,t={...t,__block:!0,tag:1},n)}("Fragment",null,e)}const _e={render:Z,h:s,createElement:s,useState:O,useEffect:Q,useAction:L,useRef:I,useReducer:P,useMemo:R,useLayoutEffect:B,useContext:T,useCallback:M,Fragment:de};exports.Fragment=de,exports.KeepAlive=function(e){const[t,r]=O([]),{children:o,max:s,include:l,exclude:i}=e,u=o.name;let c=!1;if(L((()=>{(l&&(!u||!pe(l,u))||i&&u&&pe(i,u))&&(c=!0)}),[l,i,u]),c)return o;const f=o.key;return ae.get(f)?(o.node=ae.get(f),n(t,f),t.push(f),r(t)):(ae.set(f,o),t.push(f),t.length>s&&function(e,t,r){n(t,r),e.set(r,null)}(ae,t,t[0]),r(t)),o},exports.Suspense=function({children:e}){return s("div",{__suspense_container:!0,class:"__limbo_suspense_container"},e)},exports.createContext=function(e){const t={value:e,_subscribe:new Set,Provider:function({value:e,children:n}){return L((()=>{t.value=e}),[e]),B((()=>{t.updateSub()}),[e]),n},Consumer:function({children:e,selector:n}){return function(e,t){const n=Object.assign({},e.props,t);return{...e,props:n}}(e,{value:T(t,n)})},addSub(e){this._subscribe.add(e)},updateSub(){this._subscribe.forEach((e=>{e(this.value)}))},deleteSub(e){this._subscribe.delete(e)}};return t},exports.createElement=s,exports.default=_e,exports.h=s,exports.render=Z,exports.useAction=L,exports.useCallback=M,exports.useContext=T,exports.useEffect=Q,exports.useLayoutEffect=B,exports.useMemo=R,exports.useReducer=P,exports.useRef=I,exports.useState=O;
